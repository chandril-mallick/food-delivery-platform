{"ast":null,"code":"// services/orderService.js\nimport { createOrder, getUserOrders, getOrderById, updateOrderStatus, subscribeToOrder, subscribeToUserOrders } from '../firebase/firestore';\nimport adminNotificationService from './adminNotificationService';\nimport ErrorHandler from '../utils/errorHandler';\n\n// Order status constants\nexport const ORDER_STATUS = {\n  PENDING: 'pending',\n  CONFIRMED: 'confirmed',\n  PREPARING: 'preparing',\n  OUT_FOR_DELIVERY: 'out_for_delivery',\n  DELIVERED: 'delivered',\n  CANCELLED: 'cancelled'\n};\n\n// Payment method constants\nexport const PAYMENT_METHODS = {\n  COD: 'cash_on_delivery',\n  ONLINE: 'online',\n  WALLET: 'wallet'\n};\n\n// Order service class\nclass OrderService {\n  // Place a new order\n  static async placeOrder(orderData) {\n    try {\n      const {\n        userId,\n        items,\n        deliveryAddress,\n        paymentMethod = PAYMENT_METHODS.COD,\n        specialInstructions = '',\n        contactNumber\n      } = orderData;\n\n      // Calculate totals\n      const subtotal = items.reduce((total, item) => total + item.price * item.qty, 0);\n      const deliveryFee = subtotal > 500 ? 0 : 50; // Free delivery above ₹500\n      const taxes = Math.round(subtotal * 0.05); // 5% tax\n      const total = subtotal + deliveryFee + taxes;\n\n      // Prepare order object\n      const order = {\n        userId,\n        items: items.map(item => ({\n          id: item.id,\n          name: item.name,\n          price: item.price,\n          qty: item.qty,\n          image: item.image || '',\n          category: item.category || ''\n        })),\n        deliveryAddress: {\n          street: deliveryAddress.street,\n          city: deliveryAddress.city,\n          state: deliveryAddress.state,\n          pincode: deliveryAddress.pincode,\n          landmark: deliveryAddress.landmark || ''\n        },\n        contactNumber,\n        paymentMethod,\n        specialInstructions,\n        pricing: {\n          subtotal,\n          deliveryFee,\n          taxes,\n          total\n        },\n        status: ORDER_STATUS.PENDING,\n        estimatedDeliveryTime: new Date(Date.now() + 30 * 60 * 1000),\n        // 30 minutes\n        orderNumber: `ORD-${Date.now()}`\n      };\n      const orderId = await createOrder(order);\n\n      // Trigger admin notification for new order\n      const orderWithId = {\n        id: orderId,\n        ...order\n      };\n      try {\n        // Send immediate notification to all active admin sessions\n        adminNotificationService.notifyAdminsOfNewOrder(orderWithId);\n      } catch (notificationError) {\n        console.error('Failed to send admin notification:', notificationError);\n        // Don't fail the order if notification fails\n      }\n\n      // Return order with ID\n      return {\n        id: orderId,\n        ...order,\n        success: true,\n        message: 'Order placed successfully!'\n      };\n    } catch (error) {\n      ErrorHandler.handleOrderError(error);\n      throw new Error('Failed to place order. Please try again.');\n    }\n  }\n\n  // Get user's order history\n  static async getOrderHistory(userId) {\n    try {\n      const orders = await getUserOrders(userId);\n      return orders;\n    } catch (error) {\n      console.error('Error fetching order history:', error);\n      throw new Error('Failed to fetch order history.');\n    }\n  }\n\n  // Get specific order details\n  static async getOrderDetails(orderId) {\n    try {\n      const order = await getOrderById(orderId);\n      return order;\n    } catch (error) {\n      console.error('Error fetching order details:', error);\n      throw new Error('Failed to fetch order details.');\n    }\n  }\n\n  // Update order status (for admin/restaurant)\n  static async updateStatus(orderId, status) {\n    try {\n      await updateOrderStatus(orderId, status);\n      return {\n        success: true,\n        message: 'Order status updated successfully!'\n      };\n    } catch (error) {\n      console.error('Error updating order status:', error);\n      throw new Error('Failed to update order status.');\n    }\n  }\n\n  // Cancel order (only if status is pending or confirmed)\n  static async cancelOrder(orderId) {\n    try {\n      const order = await getOrderById(orderId);\n      if (order.status === ORDER_STATUS.PENDING || order.status === ORDER_STATUS.CONFIRMED) {\n        await updateOrderStatus(orderId, ORDER_STATUS.CANCELLED);\n        return {\n          success: true,\n          message: 'Order cancelled successfully!'\n        };\n      } else {\n        throw new Error('Order cannot be cancelled at this stage.');\n      }\n    } catch (error) {\n      console.error('Error cancelling order:', error);\n      throw error;\n    }\n  }\n\n  // Subscribe to real-time order updates\n  static subscribeToOrderUpdates(orderId, callback) {\n    return subscribeToOrder(orderId, callback);\n  }\n\n  // Subscribe to user's orders real-time updates\n  static subscribeToUserOrderUpdates(userId, callback) {\n    console.log('OrderService: Setting up subscription for userId:', userId);\n    return subscribeToUserOrders(userId, orders => {\n      console.log('OrderService: Firebase returned orders:', orders.length, 'orders');\n      console.log('OrderService: Orders details:', orders);\n      callback(orders);\n    });\n  }\n\n  // Get order status display text\n  static getStatusDisplayText(status) {\n    const statusMap = {\n      [ORDER_STATUS.PENDING]: 'Order Placed',\n      [ORDER_STATUS.CONFIRMED]: 'Order Confirmed',\n      [ORDER_STATUS.PREPARING]: 'Preparing Your Food',\n      [ORDER_STATUS.OUT_FOR_DELIVERY]: 'Out for Delivery',\n      [ORDER_STATUS.DELIVERED]: 'Delivered',\n      [ORDER_STATUS.CANCELLED]: 'Cancelled'\n    };\n    return statusMap[status] || status;\n  }\n\n  // Get order status color for UI\n  static getStatusColor(status) {\n    const colorMap = {\n      [ORDER_STATUS.PENDING]: 'text-yellow-600 bg-yellow-100',\n      [ORDER_STATUS.CONFIRMED]: 'text-blue-600 bg-blue-100',\n      [ORDER_STATUS.PREPARING]: 'text-orange-600 bg-orange-100',\n      [ORDER_STATUS.OUT_FOR_DELIVERY]: 'text-purple-600 bg-purple-100',\n      [ORDER_STATUS.DELIVERED]: 'text-green-600 bg-green-100',\n      [ORDER_STATUS.CANCELLED]: 'text-red-600 bg-red-100'\n    };\n    return colorMap[status] || 'text-gray-600 bg-gray-100';\n  }\n\n  // Calculate estimated delivery time\n  static calculateDeliveryTime(orderTime, status) {\n    const baseTime = 30; // 30 minutes base delivery time\n    const statusMultiplier = {\n      [ORDER_STATUS.PENDING]: 1,\n      [ORDER_STATUS.CONFIRMED]: 0.9,\n      [ORDER_STATUS.PREPARING]: 0.7,\n      [ORDER_STATUS.OUT_FOR_DELIVERY]: 0.3,\n      [ORDER_STATUS.DELIVERED]: 0,\n      [ORDER_STATUS.CANCELLED]: 0\n    };\n    if (status === ORDER_STATUS.DELIVERED || status === ORDER_STATUS.CANCELLED) {\n      return null;\n    }\n    const remainingTime = Math.ceil(baseTime * (statusMultiplier[status] || 1));\n    const estimatedTime = new Date(orderTime.getTime() + remainingTime * 60 * 1000);\n    return estimatedTime;\n  }\n\n  // Validate delivery address\n  static validateDeliveryAddress(address) {\n    const required = ['street', 'city', 'state', 'pincode'];\n    const missing = required.filter(field => !address[field] || address[field].trim() === '');\n    if (missing.length > 0) {\n      throw new Error(`Missing required address fields: ${missing.join(', ')}`);\n    }\n\n    // Validate pincode format (6 digits)\n    if (!/^\\d{6}$/.test(address.pincode)) {\n      throw new Error('Pincode must be 6 digits');\n    }\n    return true;\n  }\n\n  // Format order for display\n  static formatOrderForDisplay(order) {\n    var _order$pricing;\n    return {\n      ...order,\n      formattedTotal: `₹${((_order$pricing = order.pricing) === null || _order$pricing === void 0 ? void 0 : _order$pricing.total) || 0}`,\n      formattedDate: order.createdAt ? new Date(order.createdAt.seconds * 1000).toLocaleDateString() : '',\n      formattedTime: order.createdAt ? new Date(order.createdAt.seconds * 1000).toLocaleTimeString() : '',\n      statusText: this.getStatusDisplayText(order.status),\n      statusColor: this.getStatusColor(order.status),\n      canCancel: order.status === ORDER_STATUS.PENDING || order.status === ORDER_STATUS.CONFIRMED\n    };\n  }\n}\nexport default OrderService;","map":{"version":3,"names":["createOrder","getUserOrders","getOrderById","updateOrderStatus","subscribeToOrder","subscribeToUserOrders","adminNotificationService","ErrorHandler","ORDER_STATUS","PENDING","CONFIRMED","PREPARING","OUT_FOR_DELIVERY","DELIVERED","CANCELLED","PAYMENT_METHODS","COD","ONLINE","WALLET","OrderService","placeOrder","orderData","userId","items","deliveryAddress","paymentMethod","specialInstructions","contactNumber","subtotal","reduce","total","item","price","qty","deliveryFee","taxes","Math","round","order","map","id","name","image","category","street","city","state","pincode","landmark","pricing","status","estimatedDeliveryTime","Date","now","orderNumber","orderId","orderWithId","notifyAdminsOfNewOrder","notificationError","console","error","success","message","handleOrderError","Error","getOrderHistory","orders","getOrderDetails","updateStatus","cancelOrder","subscribeToOrderUpdates","callback","subscribeToUserOrderUpdates","log","length","getStatusDisplayText","statusMap","getStatusColor","colorMap","calculateDeliveryTime","orderTime","baseTime","statusMultiplier","remainingTime","ceil","estimatedTime","getTime","validateDeliveryAddress","address","required","missing","filter","field","trim","join","test","formatOrderForDisplay","_order$pricing","formattedTotal","formattedDate","createdAt","seconds","toLocaleDateString","formattedTime","toLocaleTimeString","statusText","statusColor","canCancel"],"sources":["/Users/chandrilmallick/Downloads/web-projects/dabba-app/frontend/src/services/orderService.js"],"sourcesContent":["// services/orderService.js\nimport { \n  createOrder, \n  getUserOrders, \n  getOrderById, \n  updateOrderStatus,\n  subscribeToOrder,\n  subscribeToUserOrders\n} from '../firebase/firestore';\nimport adminNotificationService from './adminNotificationService';\nimport ErrorHandler from '../utils/errorHandler';\n\n// Order status constants\nexport const ORDER_STATUS = {\n  PENDING: 'pending',\n  CONFIRMED: 'confirmed',\n  PREPARING: 'preparing',\n  OUT_FOR_DELIVERY: 'out_for_delivery',\n  DELIVERED: 'delivered',\n  CANCELLED: 'cancelled'\n};\n\n// Payment method constants\nexport const PAYMENT_METHODS = {\n  COD: 'cash_on_delivery',\n  ONLINE: 'online',\n  WALLET: 'wallet'\n};\n\n// Order service class\nclass OrderService {\n  // Place a new order\n  static async placeOrder(orderData) {\n    try {\n      const {\n        userId,\n        items,\n        deliveryAddress,\n        paymentMethod = PAYMENT_METHODS.COD,\n        specialInstructions = '',\n        contactNumber\n      } = orderData;\n\n      // Calculate totals\n      const subtotal = items.reduce((total, item) => total + (item.price * item.qty), 0);\n      const deliveryFee = subtotal > 500 ? 0 : 50; // Free delivery above ₹500\n      const taxes = Math.round(subtotal * 0.05); // 5% tax\n      const total = subtotal + deliveryFee + taxes;\n\n      // Prepare order object\n      const order = {\n        userId,\n        items: items.map(item => ({\n          id: item.id,\n          name: item.name,\n          price: item.price,\n          qty: item.qty,\n          image: item.image || '',\n          category: item.category || ''\n        })),\n        deliveryAddress: {\n          street: deliveryAddress.street,\n          city: deliveryAddress.city,\n          state: deliveryAddress.state,\n          pincode: deliveryAddress.pincode,\n          landmark: deliveryAddress.landmark || ''\n        },\n        contactNumber,\n        paymentMethod,\n        specialInstructions,\n        pricing: {\n          subtotal,\n          deliveryFee,\n          taxes,\n          total\n        },\n        status: ORDER_STATUS.PENDING,\n        estimatedDeliveryTime: new Date(Date.now() + 30 * 60 * 1000), // 30 minutes\n        orderNumber: `ORD-${Date.now()}`\n      };\n\n      const orderId = await createOrder(order);\n      \n      // Trigger admin notification for new order\n      const orderWithId = { id: orderId, ...order };\n      try {\n        // Send immediate notification to all active admin sessions\n        adminNotificationService.notifyAdminsOfNewOrder(orderWithId);\n      } catch (notificationError) {\n        console.error('Failed to send admin notification:', notificationError);\n        // Don't fail the order if notification fails\n      }\n      \n      // Return order with ID\n      return {\n        id: orderId,\n        ...order,\n        success: true,\n        message: 'Order placed successfully!'\n      };\n    } catch (error) {\n      ErrorHandler.handleOrderError(error);\n      throw new Error('Failed to place order. Please try again.');\n    }\n  }\n\n  // Get user's order history\n  static async getOrderHistory(userId) {\n    try {\n      const orders = await getUserOrders(userId);\n      return orders;\n    } catch (error) {\n      console.error('Error fetching order history:', error);\n      throw new Error('Failed to fetch order history.');\n    }\n  }\n\n  // Get specific order details\n  static async getOrderDetails(orderId) {\n    try {\n      const order = await getOrderById(orderId);\n      return order;\n    } catch (error) {\n      console.error('Error fetching order details:', error);\n      throw new Error('Failed to fetch order details.');\n    }\n  }\n\n  // Update order status (for admin/restaurant)\n  static async updateStatus(orderId, status) {\n    try {\n      await updateOrderStatus(orderId, status);\n      return { success: true, message: 'Order status updated successfully!' };\n    } catch (error) {\n      console.error('Error updating order status:', error);\n      throw new Error('Failed to update order status.');\n    }\n  }\n\n  // Cancel order (only if status is pending or confirmed)\n  static async cancelOrder(orderId) {\n    try {\n      const order = await getOrderById(orderId);\n      \n      if (order.status === ORDER_STATUS.PENDING || order.status === ORDER_STATUS.CONFIRMED) {\n        await updateOrderStatus(orderId, ORDER_STATUS.CANCELLED);\n        return { success: true, message: 'Order cancelled successfully!' };\n      } else {\n        throw new Error('Order cannot be cancelled at this stage.');\n      }\n    } catch (error) {\n      console.error('Error cancelling order:', error);\n      throw error;\n    }\n  }\n\n  // Subscribe to real-time order updates\n  static subscribeToOrderUpdates(orderId, callback) {\n    return subscribeToOrder(orderId, callback);\n  }\n\n  // Subscribe to user's orders real-time updates\n  static subscribeToUserOrderUpdates(userId, callback) {\n    console.log('OrderService: Setting up subscription for userId:', userId);\n    return subscribeToUserOrders(userId, (orders) => {\n      console.log('OrderService: Firebase returned orders:', orders.length, 'orders');\n      console.log('OrderService: Orders details:', orders);\n      callback(orders);\n    });\n  }\n\n  // Get order status display text\n  static getStatusDisplayText(status) {\n    const statusMap = {\n      [ORDER_STATUS.PENDING]: 'Order Placed',\n      [ORDER_STATUS.CONFIRMED]: 'Order Confirmed',\n      [ORDER_STATUS.PREPARING]: 'Preparing Your Food',\n      [ORDER_STATUS.OUT_FOR_DELIVERY]: 'Out for Delivery',\n      [ORDER_STATUS.DELIVERED]: 'Delivered',\n      [ORDER_STATUS.CANCELLED]: 'Cancelled'\n    };\n    return statusMap[status] || status;\n  }\n\n  // Get order status color for UI\n  static getStatusColor(status) {\n    const colorMap = {\n      [ORDER_STATUS.PENDING]: 'text-yellow-600 bg-yellow-100',\n      [ORDER_STATUS.CONFIRMED]: 'text-blue-600 bg-blue-100',\n      [ORDER_STATUS.PREPARING]: 'text-orange-600 bg-orange-100',\n      [ORDER_STATUS.OUT_FOR_DELIVERY]: 'text-purple-600 bg-purple-100',\n      [ORDER_STATUS.DELIVERED]: 'text-green-600 bg-green-100',\n      [ORDER_STATUS.CANCELLED]: 'text-red-600 bg-red-100'\n    };\n    return colorMap[status] || 'text-gray-600 bg-gray-100';\n  }\n\n  // Calculate estimated delivery time\n  static calculateDeliveryTime(orderTime, status) {\n    const baseTime = 30; // 30 minutes base delivery time\n    const statusMultiplier = {\n      [ORDER_STATUS.PENDING]: 1,\n      [ORDER_STATUS.CONFIRMED]: 0.9,\n      [ORDER_STATUS.PREPARING]: 0.7,\n      [ORDER_STATUS.OUT_FOR_DELIVERY]: 0.3,\n      [ORDER_STATUS.DELIVERED]: 0,\n      [ORDER_STATUS.CANCELLED]: 0\n    };\n\n    if (status === ORDER_STATUS.DELIVERED || status === ORDER_STATUS.CANCELLED) {\n      return null;\n    }\n\n    const remainingTime = Math.ceil(baseTime * (statusMultiplier[status] || 1));\n    const estimatedTime = new Date(orderTime.getTime() + remainingTime * 60 * 1000);\n    \n    return estimatedTime;\n  }\n\n  // Validate delivery address\n  static validateDeliveryAddress(address) {\n    const required = ['street', 'city', 'state', 'pincode'];\n    const missing = required.filter(field => !address[field] || address[field].trim() === '');\n    \n    if (missing.length > 0) {\n      throw new Error(`Missing required address fields: ${missing.join(', ')}`);\n    }\n\n    // Validate pincode format (6 digits)\n    if (!/^\\d{6}$/.test(address.pincode)) {\n      throw new Error('Pincode must be 6 digits');\n    }\n\n    return true;\n  }\n\n  // Format order for display\n  static formatOrderForDisplay(order) {\n    return {\n      ...order,\n      formattedTotal: `₹${order.pricing?.total || 0}`,\n      formattedDate: order.createdAt ? new Date(order.createdAt.seconds * 1000).toLocaleDateString() : '',\n      formattedTime: order.createdAt ? new Date(order.createdAt.seconds * 1000).toLocaleTimeString() : '',\n      statusText: this.getStatusDisplayText(order.status),\n      statusColor: this.getStatusColor(order.status),\n      canCancel: order.status === ORDER_STATUS.PENDING || order.status === ORDER_STATUS.CONFIRMED\n    };\n  }\n}\n\nexport default OrderService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}