{"ast":null,"code":"import _objectSpread from\"/Users/chandrilmallick/Downloads/web-projects/dabba-app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// firebase/firestore.js\nimport{collection,getDocs,doc,getDoc,addDoc,setDoc,updateDoc,deleteDoc,query,where,orderBy,limit,serverTimestamp,onSnapshot}from\"firebase/firestore\";import{getAuth,signInAnonymously}from'firebase/auth';// Import the existing Firebase app and services from the main firebase.js file\nimport app,{db}from'../firebase.js';// Env flag for development logging\nconst isDev=process.env.NODE_ENV!=='production'||process.env.REACT_APP_ENABLE_DEV==='true';// Ensure there is an authenticated Firebase user (anonymous if needed)\nlet _ensuringAuth=false;const ensureFirebaseAuth=async()=>{try{const auth=getAuth(app);if(auth.currentUser||_ensuringAuth)return;_ensuringAuth=true;await signInAnonymously(auth).catch(e=>{if(isDev){// eslint-disable-next-line no-console\nconsole.warn('[Firestore] Anonymous auth failed (rules may require auth):',e===null||e===void 0?void 0:e.message);}});}finally{_ensuringAuth=false;}};// ✅ Function to fetch collection\nexport const getCollection=async collectionName=>{const colRef=collection(db,collectionName);const snapshot=await getDocs(colRef);return snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));};// ✅ Function to get a single document\nexport const getDocument=async(collectionName,docId)=>{const docRef=doc(db,collectionName,docId);const docSnap=await getDoc(docRef);if(docSnap.exists()){return _objectSpread({id:docSnap.id},docSnap.data());}else{throw new Error('Document not found');}};// ✅ Function to add a document\nexport const addDocument=async(collectionName,data)=>{const docRef=await addDoc(collection(db,collectionName),_objectSpread(_objectSpread({},data),{},{createdAt:serverTimestamp(),updatedAt:serverTimestamp()}));return docRef.id;};// ✅ Function to update a document\nexport const updateDocument=async(collectionName,docId,data)=>{const docRef=doc(db,collectionName,docId);await updateDoc(docRef,_objectSpread(_objectSpread({},data),{},{updatedAt:serverTimestamp()}));};// ✅ Function to delete a document\nexport const deleteDocument=async(collectionName,docId)=>{const docRef=doc(db,collectionName,docId);await deleteDoc(docRef);};// ===== ORDER MANAGEMENT FUNCTIONS =====\n// ✅ Create a new order\nexport const createOrder=async orderData=>{var _auth$currentUser;// Make sure Firestore write has auth context (compatible with Supabase auth flow)\nawait ensureFirebaseAuth();// Capture current Firebase auth UID to store on the order for rule checks\nconst auth=getAuth(app);const authUid=((_auth$currentUser=auth.currentUser)===null||_auth$currentUser===void 0?void 0:_auth$currentUser.uid)||null;const order=_objectSpread(_objectSpread({},orderData),{},{authUid,// used by security rules for reads/writes by the same Firebase user\nstatus:'pending',createdAt:serverTimestamp(),updatedAt:serverTimestamp(),orderNumber:\"ORD-\".concat(Date.now()),estimatedDeliveryTime:new Date(Date.now()+30*60*1000)// 30 minutes from now\n});try{const docRef=await addDoc(collection(db,'orders'),order);return docRef.id;}catch(e){// eslint-disable-next-line no-console\nconsole.error('[Firestore] createOrder failed:',(e===null||e===void 0?void 0:e.code)||(e===null||e===void 0?void 0:e.name),e===null||e===void 0?void 0:e.message);throw e;}};// ✅ Get orders by user ID\nexport const getUserOrders=async userId=>{const q=query(collection(db,'orders'),where('userId','==',userId));const snapshot=await getDocs(q);const orders=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));// Sort by createdAt in JavaScript to avoid needing a composite index\nreturn orders.sort((a,b)=>{var _a$createdAt,_a$createdAt$toDate,_b$createdAt,_b$createdAt$toDate;const aTime=((_a$createdAt=a.createdAt)===null||_a$createdAt===void 0?void 0:(_a$createdAt$toDate=_a$createdAt.toDate)===null||_a$createdAt$toDate===void 0?void 0:_a$createdAt$toDate.call(_a$createdAt))||a.createdAt||new Date(0);const bTime=((_b$createdAt=b.createdAt)===null||_b$createdAt===void 0?void 0:(_b$createdAt$toDate=_b$createdAt.toDate)===null||_b$createdAt$toDate===void 0?void 0:_b$createdAt$toDate.call(_b$createdAt))||b.createdAt||new Date(0);return bTime-aTime;// Descending order (newest first)\n});};// ✅ Get order by ID\nexport const getOrderById=async orderId=>{return await getDocument('orders',orderId);};// ✅ Update order status\nexport const updateOrderStatus=async(orderId,status)=>{await updateDocument('orders',orderId,{status});};// ✅ Get all orders (for admin)\nexport const getAllOrders=async function(){let limitCount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:50;const q=query(collection(db,'orders'),orderBy('createdAt','desc'),limit(limitCount));const snapshot=await getDocs(q);return snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));};// ✅ Get orders by status\nexport const getOrdersByStatus=async status=>{const q=query(collection(db,'orders'),where('status','==',status));const snapshot=await getDocs(q);const orders=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));// Sort by createdAt in JavaScript to avoid needing a composite index\nreturn orders.sort((a,b)=>{var _a$createdAt2,_a$createdAt2$toDate,_b$createdAt2,_b$createdAt2$toDate;const aTime=((_a$createdAt2=a.createdAt)===null||_a$createdAt2===void 0?void 0:(_a$createdAt2$toDate=_a$createdAt2.toDate)===null||_a$createdAt2$toDate===void 0?void 0:_a$createdAt2$toDate.call(_a$createdAt2))||a.createdAt||new Date(0);const bTime=((_b$createdAt2=b.createdAt)===null||_b$createdAt2===void 0?void 0:(_b$createdAt2$toDate=_b$createdAt2.toDate)===null||_b$createdAt2$toDate===void 0?void 0:_b$createdAt2$toDate.call(_b$createdAt2))||b.createdAt||new Date(0);return bTime-aTime;// Descending order (newest first)\n});};// ✅ Real-time order tracking\nexport const subscribeToOrder=(orderId,callback)=>{const docRef=doc(db,'orders',orderId);return onSnapshot(docRef,doc=>{if(doc.exists()){callback(_objectSpread({id:doc.id},doc.data()));}});};// ✅ Real-time user orders tracking\nexport const subscribeToUserOrders=(userId,callback)=>{if(isDev){// eslint-disable-next-line no-console\nconsole.log('Firebase subscribeToUserOrders: Setting up query for userId:',userId);}// Proxy unsubscribe to keep the same return type while we ensure auth first\nlet innerUnsub=()=>{};(async()=>{try{var _auth$currentUser2;// Ensure there is an auth context before opening a watch stream (rules require signed-in user)\nawait ensureFirebaseAuth();const auth=getAuth(app);const currentUid=((_auth$currentUser2=auth.currentUser)===null||_auth$currentUser2===void 0?void 0:_auth$currentUser2.uid)||null;// Prefer secure filter by authUid (the Firebase UID stored on the order).\n// Fallback to userId equality if authUid is not available (legacy data).\nconst base=collection(db,'orders');const q=currentUid?query(base,where('authUid','==',currentUid)):query(base,where('userId','==',userId));innerUnsub=onSnapshot(q,snapshot=>{if(isDev){// eslint-disable-next-line no-console\nconsole.log('Firebase subscribeToUserOrders: Snapshot received, docs count:',snapshot.docs.length);}const orders=snapshot.docs.map(doc=>{const data=_objectSpread({id:doc.id},doc.data());if(isDev){// eslint-disable-next-line no-console\nconsole.log('Firebase subscribeToUserOrders: Order doc:',doc.id,data);}return data;});// Sort by createdAt in JavaScript to avoid needing a composite index\nconst sortedOrders=orders.sort((a,b)=>{var _a$createdAt3,_a$createdAt3$toDate,_b$createdAt3,_b$createdAt3$toDate;const aTime=((_a$createdAt3=a.createdAt)===null||_a$createdAt3===void 0?void 0:(_a$createdAt3$toDate=_a$createdAt3.toDate)===null||_a$createdAt3$toDate===void 0?void 0:_a$createdAt3$toDate.call(_a$createdAt3))||a.createdAt||new Date(0);const bTime=((_b$createdAt3=b.createdAt)===null||_b$createdAt3===void 0?void 0:(_b$createdAt3$toDate=_b$createdAt3.toDate)===null||_b$createdAt3$toDate===void 0?void 0:_b$createdAt3$toDate.call(_b$createdAt3))||b.createdAt||new Date(0);return bTime-aTime;// Descending order (newest first)\n});if(isDev){// eslint-disable-next-line no-console\nconsole.log('Firebase subscribeToUserOrders: Returning sorted orders:',sortedOrders.length,'orders');}callback(sortedOrders);},error=>{console.error('Firebase subscribeToUserOrders: Error in snapshot listener:',error);});}catch(e){console.error('Firebase subscribeToUserOrders: Failed to ensure auth or attach listener:',e);}})();return()=>{try{innerUnsub();}catch(e){}};};// ===== MENU FUNCTIONS =====\n// ✅ Get menu items\nexport const getMenuItems=async()=>{try{const items=await getCollection('menuItems');if(Array.isArray(items)&&items.length>0)return items;}catch(e){// fall through to fallback\n}try{// Fallback to legacy collection name (lowercase)\nconst items=await getCollection('menu');if(Array.isArray(items)&&items.length>0)return items;}catch(e){// fall through\n}// Final fallback to capitalized collection name\nreturn await getCollection('Menu');};// ✅ Get menu item by ID\nexport const getMenuItem=async itemId=>{return await getDocument('menuItems',itemId);};// ✅ Get popular menu items\nexport const getPopularMenuItems=async()=>{try{// Try different possible collection names\nconst possibleCollections=['popularMenu','popular-menu','popular menu','popular_items','popularItems'];for(const collectionName of possibleCollections){try{const items=await getCollection(collectionName);if(items&&items.length>0){if(isDev){// eslint-disable-next-line no-console\nconsole.log(\"Found popular items in collection: \".concat(collectionName),items);}// Ensure each item has a valid image URL\nreturn items.map(item=>_objectSpread(_objectSpread({},item),{},{image:item.image||'/placeholder-dish.png'// Fallback image\n}));}}catch(e){if(isDev){// eslint-disable-next-line no-console\nconsole.log(\"Collection \".concat(collectionName,\" not found, trying next...\"));}}}// If no collection found, return fallback data\nif(isDev){// eslint-disable-next-line no-console\nconsole.warn('No popular menu items found in any collection. Using fallback data.');}return[{id:'fallback-1',name:'Chicken Biriyani',description:'Aromatic chicken biriyani',price:99,rating:4.8,deliveryTime:'30-40 min',isVeg:false,image:'/chicken-biriyani.jpeg'},{id:'fallback-2',name:'Mutton Biriyani',description:'Aromatic mutton biriyani',price:179,rating:4.7,deliveryTime:'25-35 min',isVeg:true,image:'/mutton-biriyani.jpeg'}];}catch(error){console.error('Error in getPopularMenuItems:',error);return[];}};// ===== OFFERS (PROMOTIONS) =====\n// Get all offers\nexport const getOffers=async()=>{return await getCollection('offers');};// Real-time offers subscription\nexport const subscribeToOffers=callback=>{const colRef=collection(db,'offers');return onSnapshot(colRef,snapshot=>{const items=snapshot.docs.map(d=>_objectSpread({id:d.id},d.data()));callback(items);});};// ===== USER FUNCTIONS =====\n// ✅ Create or update user profile\nexport const saveUserProfile=async(userId,userData)=>{const userRef=doc(db,'users',userId);const userSnap=await getDoc(userRef);if(userSnap.exists()){// Update existing user\nawait updateDoc(userRef,_objectSpread(_objectSpread({},userData),{},{updatedAt:serverTimestamp()}));}else{// Create new user with userId as document ID\nawait setDoc(userRef,_objectSpread(_objectSpread({},userData),{},{userId,createdAt:serverTimestamp(),updatedAt:serverTimestamp()}));}};// ✅ Get user profile\nexport const getUserProfile=async userId=>{// Ensure there is an auth context for rules that require signed-in users\nawait ensureFirebaseAuth();const userRef=doc(db,'users',userId);const userSnap=await getDoc(userRef);if(userSnap.exists()){return _objectSpread({id:userSnap.id},userSnap.data());}return null;};export{db};// ===== APP STATUS (OPEN/CLOSE) =====\n// Real-time subscription to app open/close status\nexport const subscribeToAppStatus=callback=>{const statusRef=doc(db,'settings','appStatus');return onSnapshot(statusRef,snap=>{if(snap.exists()){const data=snap.data();callback({isOpen:data.isOpen!==false,message:data.message||''});}else{// Default to open if doc missing\ncallback({isOpen:true,message:''});}},error=>{console.error('[Firestore] subscribeToAppStatus error:',error);// On error, default to open to avoid blocking users\ncallback({isOpen:true,message:''});});};// Update app open/close status\nexport const setAppStatus=async(_ref,user)=>{let{isOpen,message}=_ref;await ensureFirebaseAuth();const statusRef=doc(db,'settings','appStatus');await setDoc(statusRef,{isOpen:Boolean(isOpen),message:message||'',updatedAt:serverTimestamp(),updatedBy:(user===null||user===void 0?void 0:user.email)||(user===null||user===void 0?void 0:user.uid)||'system'},{merge:true});};// ===== SUPPORT (TICKETS) =====\n// Create a support ticket\nexport const createSupportTicket=async ticket=>{await ensureFirebaseAuth();const payload=_objectSpread(_objectSpread({status:'open',source:'web'},ticket),{},{createdAt:serverTimestamp(),updatedAt:serverTimestamp()});const ref=await addDoc(collection(db,'supportTickets'),payload);return ref.id;};// Get support tickets for a user\nexport const getUserSupportTickets=async userId=>{const q=query(collection(db,'supportTickets'),where('userId','==',userId));const snapshot=await getDocs(q);const items=snapshot.docs.map(d=>_objectSpread({id:d.id},d.data()));return items.sort((a,b)=>{var _a$createdAt4,_a$createdAt4$toDate,_b$createdAt4,_b$createdAt4$toDate;const at=((_a$createdAt4=a.createdAt)===null||_a$createdAt4===void 0?void 0:(_a$createdAt4$toDate=_a$createdAt4.toDate)===null||_a$createdAt4$toDate===void 0?void 0:_a$createdAt4$toDate.call(_a$createdAt4))||a.createdAt||new Date(0);const bt=((_b$createdAt4=b.createdAt)===null||_b$createdAt4===void 0?void 0:(_b$createdAt4$toDate=_b$createdAt4.toDate)===null||_b$createdAt4$toDate===void 0?void 0:_b$createdAt4$toDate.call(_b$createdAt4))||b.createdAt||new Date(0);return bt-at;});};// Subscribe to user's support tickets\nexport const subscribeToUserSupportTickets=(userId,callback)=>{const q=query(collection(db,'supportTickets'),where('userId','==',userId));return onSnapshot(q,snapshot=>{const items=snapshot.docs.map(d=>_objectSpread({id:d.id},d.data()));const sorted=items.sort((a,b)=>{var _a$createdAt5,_a$createdAt5$toDate,_b$createdAt5,_b$createdAt5$toDate;const at=((_a$createdAt5=a.createdAt)===null||_a$createdAt5===void 0?void 0:(_a$createdAt5$toDate=_a$createdAt5.toDate)===null||_a$createdAt5$toDate===void 0?void 0:_a$createdAt5$toDate.call(_a$createdAt5))||a.createdAt||new Date(0);const bt=((_b$createdAt5=b.createdAt)===null||_b$createdAt5===void 0?void 0:(_b$createdAt5$toDate=_b$createdAt5.toDate)===null||_b$createdAt5$toDate===void 0?void 0:_b$createdAt5$toDate.call(_b$createdAt5))||b.createdAt||new Date(0);return bt-at;});callback(sorted);});};","map":{"version":3,"names":["collection","getDocs","doc","getDoc","addDoc","setDoc","updateDoc","deleteDoc","query","where","orderBy","limit","serverTimestamp","onSnapshot","getAuth","signInAnonymously","app","db","isDev","process","env","NODE_ENV","REACT_APP_ENABLE_DEV","_ensuringAuth","ensureFirebaseAuth","auth","currentUser","catch","e","console","warn","message","getCollection","collectionName","colRef","snapshot","docs","map","_objectSpread","id","data","getDocument","docId","docRef","docSnap","exists","Error","addDocument","createdAt","updatedAt","updateDocument","deleteDocument","createOrder","orderData","_auth$currentUser","authUid","uid","order","status","orderNumber","concat","Date","now","estimatedDeliveryTime","error","code","name","getUserOrders","userId","q","orders","sort","a","b","_a$createdAt","_a$createdAt$toDate","_b$createdAt","_b$createdAt$toDate","aTime","toDate","call","bTime","getOrderById","orderId","updateOrderStatus","getAllOrders","limitCount","arguments","length","undefined","getOrdersByStatus","_a$createdAt2","_a$createdAt2$toDate","_b$createdAt2","_b$createdAt2$toDate","subscribeToOrder","callback","subscribeToUserOrders","log","innerUnsub","_auth$currentUser2","currentUid","base","sortedOrders","_a$createdAt3","_a$createdAt3$toDate","_b$createdAt3","_b$createdAt3$toDate","getMenuItems","items","Array","isArray","getMenuItem","itemId","getPopularMenuItems","possibleCollections","item","image","description","price","rating","deliveryTime","isVeg","getOffers","subscribeToOffers","d","saveUserProfile","userData","userRef","userSnap","getUserProfile","subscribeToAppStatus","statusRef","snap","isOpen","setAppStatus","_ref","user","Boolean","updatedBy","email","merge","createSupportTicket","ticket","payload","source","ref","getUserSupportTickets","_a$createdAt4","_a$createdAt4$toDate","_b$createdAt4","_b$createdAt4$toDate","at","bt","subscribeToUserSupportTickets","sorted","_a$createdAt5","_a$createdAt5$toDate","_b$createdAt5","_b$createdAt5$toDate"],"sources":["/Users/chandrilmallick/Downloads/web-projects/dabba-app/frontend/src/firebase/firestore.js"],"sourcesContent":["// firebase/firestore.js\nimport { \n  collection, \n  getDocs, \n  doc, \n  getDoc, \n  addDoc, \n  setDoc,\n  updateDoc, \n  deleteDoc, \n  query, \n  where, \n  orderBy, \n  limit,\n  serverTimestamp,\n  onSnapshot\n} from \"firebase/firestore\";\nimport { getAuth, signInAnonymously } from 'firebase/auth';\n\n// Import the existing Firebase app and services from the main firebase.js file\nimport app, { db } from '../firebase.js';\n\n// Env flag for development logging\nconst isDev = process.env.NODE_ENV !== 'production' || process.env.REACT_APP_ENABLE_DEV === 'true';\n\n// Ensure there is an authenticated Firebase user (anonymous if needed)\nlet _ensuringAuth = false;\nconst ensureFirebaseAuth = async () => {\n  try {\n    const auth = getAuth(app);\n    if (auth.currentUser || _ensuringAuth) return;\n    _ensuringAuth = true;\n    await signInAnonymously(auth).catch((e) => {\n      if (isDev) {\n        // eslint-disable-next-line no-console\n        console.warn('[Firestore] Anonymous auth failed (rules may require auth):', e?.message);\n      }\n    });\n  } finally {\n    _ensuringAuth = false;\n  }\n};\n\n// ✅ Function to fetch collection\nexport const getCollection = async (collectionName) => {\n  const colRef = collection(db, collectionName);\n  const snapshot = await getDocs(colRef);\n  return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n};\n\n// ✅ Function to get a single document\nexport const getDocument = async (collectionName, docId) => {\n  const docRef = doc(db, collectionName, docId);\n  const docSnap = await getDoc(docRef);\n  if (docSnap.exists()) {\n    return { id: docSnap.id, ...docSnap.data() };\n  } else {\n    throw new Error('Document not found');\n  }\n};\n\n// ✅ Function to add a document\nexport const addDocument = async (collectionName, data) => {\n  const docRef = await addDoc(collection(db, collectionName), {\n    ...data,\n    createdAt: serverTimestamp(),\n    updatedAt: serverTimestamp()\n  });\n  return docRef.id;\n};\n\n// ✅ Function to update a document\nexport const updateDocument = async (collectionName, docId, data) => {\n  const docRef = doc(db, collectionName, docId);\n  await updateDoc(docRef, {\n    ...data,\n    updatedAt: serverTimestamp()\n  });\n};\n\n// ✅ Function to delete a document\nexport const deleteDocument = async (collectionName, docId) => {\n  const docRef = doc(db, collectionName, docId);\n  await deleteDoc(docRef);\n};\n\n// ===== ORDER MANAGEMENT FUNCTIONS =====\n\n// ✅ Create a new order\nexport const createOrder = async (orderData) => {\n  // Make sure Firestore write has auth context (compatible with Supabase auth flow)\n  await ensureFirebaseAuth();\n\n  // Capture current Firebase auth UID to store on the order for rule checks\n  const auth = getAuth(app);\n  const authUid = auth.currentUser?.uid || null;\n\n  const order = {\n    ...orderData,\n    authUid, // used by security rules for reads/writes by the same Firebase user\n    status: 'pending',\n    createdAt: serverTimestamp(),\n    updatedAt: serverTimestamp(),\n    orderNumber: `ORD-${Date.now()}`,\n    estimatedDeliveryTime: new Date(Date.now() + 30 * 60 * 1000) // 30 minutes from now\n  };\n\n  try {\n    const docRef = await addDoc(collection(db, 'orders'), order);\n    return docRef.id;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error('[Firestore] createOrder failed:', e?.code || e?.name, e?.message);\n    throw e;\n  }\n};\n\n// ✅ Get orders by user ID\nexport const getUserOrders = async (userId) => {\n  const q = query(\n    collection(db, 'orders'),\n    where('userId', '==', userId)\n  );\n  const snapshot = await getDocs(q);\n  const orders = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n  // Sort by createdAt in JavaScript to avoid needing a composite index\n  return orders.sort((a, b) => {\n    const aTime = a.createdAt?.toDate?.() || a.createdAt || new Date(0);\n    const bTime = b.createdAt?.toDate?.() || b.createdAt || new Date(0);\n    return bTime - aTime; // Descending order (newest first)\n  });\n};\n\n// ✅ Get order by ID\nexport const getOrderById = async (orderId) => {\n  return await getDocument('orders', orderId);\n};\n\n// ✅ Update order status\nexport const updateOrderStatus = async (orderId, status) => {\n  await updateDocument('orders', orderId, { status });\n};\n\n// ✅ Get all orders (for admin)\nexport const getAllOrders = async (limitCount = 50) => {\n  const q = query(\n    collection(db, 'orders'),\n    orderBy('createdAt', 'desc'),\n    limit(limitCount)\n  );\n  const snapshot = await getDocs(q);\n  return snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n};\n\n// ✅ Get orders by status\nexport const getOrdersByStatus = async (status) => {\n  const q = query(\n    collection(db, 'orders'),\n    where('status', '==', status)\n  );\n  const snapshot = await getDocs(q);\n  const orders = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n  // Sort by createdAt in JavaScript to avoid needing a composite index\n  return orders.sort((a, b) => {\n    const aTime = a.createdAt?.toDate?.() || a.createdAt || new Date(0);\n    const bTime = b.createdAt?.toDate?.() || b.createdAt || new Date(0);\n    return bTime - aTime; // Descending order (newest first)\n  });\n};\n\n// ✅ Real-time order tracking\nexport const subscribeToOrder = (orderId, callback) => {\n  const docRef = doc(db, 'orders', orderId);\n  return onSnapshot(docRef, (doc) => {\n    if (doc.exists()) {\n      callback({ id: doc.id, ...doc.data() });\n    }\n  });\n};\n\n// ✅ Real-time user orders tracking\nexport const subscribeToUserOrders = (userId, callback) => {\n  if (isDev) {\n    // eslint-disable-next-line no-console\n    console.log('Firebase subscribeToUserOrders: Setting up query for userId:', userId);\n  }\n  // Proxy unsubscribe to keep the same return type while we ensure auth first\n  let innerUnsub = () => {};\n\n  (async () => {\n    try {\n      // Ensure there is an auth context before opening a watch stream (rules require signed-in user)\n      await ensureFirebaseAuth();\n      const auth = getAuth(app);\n      const currentUid = auth.currentUser?.uid || null;\n\n      // Prefer secure filter by authUid (the Firebase UID stored on the order).\n      // Fallback to userId equality if authUid is not available (legacy data).\n      const base = collection(db, 'orders');\n      const q = currentUid\n        ? query(base, where('authUid', '==', currentUid))\n        : query(base, where('userId', '==', userId));\n      innerUnsub = onSnapshot(q, (snapshot) => {\n        if (isDev) {\n          // eslint-disable-next-line no-console\n          console.log('Firebase subscribeToUserOrders: Snapshot received, docs count:', snapshot.docs.length);\n        }\n        const orders = snapshot.docs.map(doc => {\n          const data = { id: doc.id, ...doc.data() };\n          if (isDev) {\n            // eslint-disable-next-line no-console\n            console.log('Firebase subscribeToUserOrders: Order doc:', doc.id, data);\n          }\n          return data;\n        });\n        // Sort by createdAt in JavaScript to avoid needing a composite index\n        const sortedOrders = orders.sort((a, b) => {\n          const aTime = a.createdAt?.toDate?.() || a.createdAt || new Date(0);\n          const bTime = b.createdAt?.toDate?.() || b.createdAt || new Date(0);\n          return bTime - aTime; // Descending order (newest first)\n        });\n        if (isDev) {\n          // eslint-disable-next-line no-console\n          console.log('Firebase subscribeToUserOrders: Returning sorted orders:', sortedOrders.length, 'orders');\n        }\n        callback(sortedOrders);\n      }, (error) => {\n        console.error('Firebase subscribeToUserOrders: Error in snapshot listener:', error);\n      });\n    } catch (e) {\n      console.error('Firebase subscribeToUserOrders: Failed to ensure auth or attach listener:', e);\n    }\n  })();\n\n  return () => {\n    try { innerUnsub(); } catch (e) {}\n  };\n};\n\n// ===== MENU FUNCTIONS =====\n\n// ✅ Get menu items\nexport const getMenuItems = async () => {\n  try {\n    const items = await getCollection('menuItems');\n    if (Array.isArray(items) && items.length > 0) return items;\n  } catch (e) {\n    // fall through to fallback\n  }\n  try {\n    // Fallback to legacy collection name (lowercase)\n    const items = await getCollection('menu');\n    if (Array.isArray(items) && items.length > 0) return items;\n  } catch (e) {\n    // fall through\n  }\n  // Final fallback to capitalized collection name\n  return await getCollection('Menu');\n};\n\n// ✅ Get menu item by ID\nexport const getMenuItem = async (itemId) => {\n  return await getDocument('menuItems', itemId);\n};\n\n// ✅ Get popular menu items\nexport const getPopularMenuItems = async () => {\n  try {\n    // Try different possible collection names\n    const possibleCollections = ['popularMenu', 'popular-menu', 'popular menu', 'popular_items', 'popularItems'];\n    \n    for (const collectionName of possibleCollections) {\n      try {\n        const items = await getCollection(collectionName);\n        if (items && items.length > 0) {\n          if (isDev) {\n            // eslint-disable-next-line no-console\n            console.log(`Found popular items in collection: ${collectionName}`, items);\n          }\n          // Ensure each item has a valid image URL\n          return items.map(item => ({\n            ...item,\n            image: item.image || '/placeholder-dish.png' // Fallback image\n          }));\n        }\n      } catch (e) {\n        if (isDev) {\n          // eslint-disable-next-line no-console\n          console.log(`Collection ${collectionName} not found, trying next...`);\n        }\n      }\n    }\n    \n    // If no collection found, return fallback data\n    if (isDev) {\n      // eslint-disable-next-line no-console\n      console.warn('No popular menu items found in any collection. Using fallback data.');\n    }\n    return [\n      {\n        id: 'fallback-1',\n        name: 'Chicken Biriyani',\n        description: 'Aromatic chicken biriyani',\n        price: 99,\n        rating: 4.8,\n        deliveryTime: '30-40 min',\n        isVeg: false,\n        image: '/chicken-biriyani.jpeg'\n      },\n      {\n        id: 'fallback-2',\n        name: 'Mutton Biriyani',\n        description: 'Aromatic mutton biriyani',\n        price: 179,\n        rating: 4.7,\n        deliveryTime: '25-35 min',\n        isVeg: true,\n        image: '/mutton-biriyani.jpeg'\n      }\n    ];\n  } catch (error) {\n    console.error('Error in getPopularMenuItems:', error);\n    return [];\n  }\n};\n\n// ===== OFFERS (PROMOTIONS) =====\n\n// Get all offers\nexport const getOffers = async () => {\n  return await getCollection('offers');\n};\n\n// Real-time offers subscription\nexport const subscribeToOffers = (callback) => {\n  const colRef = collection(db, 'offers');\n  return onSnapshot(colRef, (snapshot) => {\n    const items = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));\n    callback(items);\n  });\n};\n\n// ===== USER FUNCTIONS =====\n\n// ✅ Create or update user profile\nexport const saveUserProfile = async (userId, userData) => {\n  const userRef = doc(db, 'users', userId);\n  const userSnap = await getDoc(userRef);\n  \n  if (userSnap.exists()) {\n    // Update existing user\n    await updateDoc(userRef, {\n      ...userData,\n      updatedAt: serverTimestamp()\n    });\n  } else {\n    // Create new user with userId as document ID\n    await setDoc(userRef, {\n      ...userData,\n      userId,\n      createdAt: serverTimestamp(),\n      updatedAt: serverTimestamp()\n    });\n  }\n};\n\n// ✅ Get user profile\nexport const getUserProfile = async (userId) => {\n  // Ensure there is an auth context for rules that require signed-in users\n  await ensureFirebaseAuth();\n  const userRef = doc(db, 'users', userId);\n  const userSnap = await getDoc(userRef);\n  \n  if (userSnap.exists()) {\n    return { id: userSnap.id, ...userSnap.data() };\n  }\n  return null;\n};\n\nexport { db };\n\n// ===== APP STATUS (OPEN/CLOSE) =====\n\n// Real-time subscription to app open/close status\nexport const subscribeToAppStatus = (callback) => {\n  const statusRef = doc(db, 'settings', 'appStatus');\n  return onSnapshot(statusRef, (snap) => {\n    if (snap.exists()) {\n      const data = snap.data();\n      callback({ isOpen: data.isOpen !== false, message: data.message || '' });\n    } else {\n      // Default to open if doc missing\n      callback({ isOpen: true, message: '' });\n    }\n  }, (error) => {\n    console.error('[Firestore] subscribeToAppStatus error:', error);\n    // On error, default to open to avoid blocking users\n    callback({ isOpen: true, message: '' });\n  });\n};\n\n// Update app open/close status\nexport const setAppStatus = async ({ isOpen, message }, user) => {\n  await ensureFirebaseAuth();\n  const statusRef = doc(db, 'settings', 'appStatus');\n  await setDoc(statusRef, {\n    isOpen: Boolean(isOpen),\n    message: message || '',\n    updatedAt: serverTimestamp(),\n    updatedBy: user?.email || user?.uid || 'system'\n  }, { merge: true });\n};\n\n// ===== SUPPORT (TICKETS) =====\n\n// Create a support ticket\nexport const createSupportTicket = async (ticket) => {\n  await ensureFirebaseAuth();\n  const payload = {\n    status: 'open',\n    source: 'web',\n    ...ticket,\n    createdAt: serverTimestamp(),\n    updatedAt: serverTimestamp(),\n  };\n  const ref = await addDoc(collection(db, 'supportTickets'), payload);\n  return ref.id;\n};\n\n// Get support tickets for a user\nexport const getUserSupportTickets = async (userId) => {\n  const q = query(\n    collection(db, 'supportTickets'),\n    where('userId', '==', userId)\n  );\n  const snapshot = await getDocs(q);\n  const items = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));\n  return items.sort((a, b) => {\n    const at = a.createdAt?.toDate?.() || a.createdAt || new Date(0);\n    const bt = b.createdAt?.toDate?.() || b.createdAt || new Date(0);\n    return bt - at;\n  });\n};\n\n// Subscribe to user's support tickets\nexport const subscribeToUserSupportTickets = (userId, callback) => {\n  const q = query(\n    collection(db, 'supportTickets'),\n    where('userId', '==', userId)\n  );\n  return onSnapshot(q, (snapshot) => {\n    const items = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));\n    const sorted = items.sort((a, b) => {\n      const at = a.createdAt?.toDate?.() || a.createdAt || new Date(0);\n      const bt = b.createdAt?.toDate?.() || b.createdAt || new Date(0);\n      return bt - at;\n    });\n    callback(sorted);\n  });\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}