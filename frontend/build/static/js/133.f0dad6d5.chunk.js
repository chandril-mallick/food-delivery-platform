/*! For license information please see 133.f0dad6d5.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkdabba_app=self.webpackChunkdabba_app||[]).push([[133],{133:(e,s,t)=>{t.r(s),t.d(s,{default:()=>b});var r=t(5043),a=t(5187),l=t(5475),d=t(1373),i=t(2339),n=t(5088),c=t(2054),o=t(8372),x=t(7784);const m=(0,x.A)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),h=(0,x.A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);var u=t(6245),g=t(8006),v=t(1286),N=t(579);const p=e=>{var s,t;let{userId:a}=e;const[x,p]=(0,r.useState)([]),[b,j]=(0,r.useState)(!0),[w,y]=(0,r.useState)(null),[f,E]=(0,r.useState)("all");(0,r.useEffect)(()=>{if(!a)return console.log("OrderHistory: No userId provided"),j(!1),void p([]);let e;console.log("OrderHistory: Setting up subscription for userId:",a),j(!0);try{e=d.Ay.subscribeToUserOrderUpdates(a,e=>{console.log("OrderHistory: Received orders update:",e.length,"orders"),console.log("OrderHistory: Orders data:",e),p(e),j(!1),y(null)})}catch(w){console.error("OrderHistory: Error setting up subscription:",w),y("Failed to load orders. Please check your connection and try again."),j(!1)}return()=>{console.log("OrderHistory: Cleaning up subscription"),e&&e()}},[a]);const D=e=>{if(!e)return"";return(e.seconds?new Date(1e3*e.seconds):new Date(e)).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},A=e=>{switch(e){case d.w8.PENDING:return(0,N.jsx)(n.A,{className:"w-5 h-5"});case d.w8.CONFIRMED:return(0,N.jsx)(c.A,{className:"w-5 h-5"});case d.w8.PREPARING:return(0,N.jsx)(o.A,{className:"w-5 h-5"});case d.w8.OUT_FOR_DELIVERY:return(0,N.jsx)(m,{className:"w-5 h-5"});case d.w8.DELIVERED:return(0,N.jsx)(h,{className:"w-5 h-5"});case d.w8.CANCELLED:return(0,N.jsx)(u.A,{className:"w-5 h-5"});default:return(0,N.jsx)(n.A,{className:"w-5 h-5"})}},L=e=>{switch(e){case d.w8.PENDING:return 20;case d.w8.CONFIRMED:return 40;case d.w8.PREPARING:return 60;case d.w8.OUT_FOR_DELIVERY:return 80;case d.w8.DELIVERED:return 100;case d.w8.CANCELLED:default:return 0}},C=e=>{var s;if(e.status===d.w8.DELIVERED)return"Delivered";if(e.status===d.w8.CANCELLED)return"Cancelled";const t=null!==(s=e.createdAt)&&void 0!==s&&s.seconds?new Date(1e3*e.createdAt.seconds):new Date(e.createdAt),r=new Date(t.getTime()+18e5),a=new Date;if(r<=a)return"Should arrive soon";const l=Math.ceil((r-a)/6e4);return"".concat(l," min remaining")},I=x.filter(e=>e.status!==d.w8.DELIVERED&&e.status!==d.w8.CANCELLED),R=x.filter(e=>e.status===d.w8.DELIVERED||e.status===d.w8.CANCELLED),k=x.filter(e=>"all"===f||("active"===f?e.status!==d.w8.DELIVERED&&e.status!==d.w8.CANCELLED:"completed"===f?e.status===d.w8.DELIVERED||e.status===d.w8.CANCELLED:e.status===f)),O=[{value:"all",label:"All Orders",count:x.length},{value:"active",label:"Active Orders",count:I.length},{value:"completed",label:"Completed",count:R.length},{value:d.w8.PENDING,label:"Pending",count:x.filter(e=>e.status===d.w8.PENDING).length},{value:d.w8.CONFIRMED,label:"Confirmed",count:x.filter(e=>e.status===d.w8.CONFIRMED).length},{value:d.w8.PREPARING,label:"Preparing",count:x.filter(e=>e.status===d.w8.PREPARING).length},{value:d.w8.OUT_FOR_DELIVERY,label:"Out for Delivery",count:x.filter(e=>e.status===d.w8.OUT_FOR_DELIVERY).length},{value:d.w8.DELIVERED,label:"Delivered",count:x.filter(e=>e.status===d.w8.DELIVERED).length},{value:d.w8.CANCELLED,label:"Cancelled",count:x.filter(e=>e.status===d.w8.CANCELLED).length}],V=e=>{var s,t,r,a,n,c,o,x,u,p,b,j,y,f;return(0,N.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm rounded-2xl shadow-md border border-white/10 overflow-hidden hover:shadow-xl transition-all duration-300",children:[(0,N.jsx)("div",{className:"bg-white/5 backdrop-blur-sm px-6 py-4 border-b border-white/10",children:(0,N.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,N.jsxs)("div",{className:"flex items-center gap-3 mb-2 sm:mb-0",children:[(0,N.jsx)("div",{className:"p-2 rounded-full ".concat((f=e.status,d.Ay.getStatusColor(f))," flex items-center justify-center"),children:A(e.status)}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("h3",{className:"text-lg font-bold text-white",children:["Order #",e.orderNumber]}),(0,N.jsx)("p",{className:"text-sm text-gray-300",children:D(e.createdAt)})]})]}),(0,N.jsxs)("div",{className:"text-right",children:[(0,N.jsxs)("div",{className:"text-2xl font-bold text-orange-300",children:["\u20b9",null===(s=e.pricing)||void 0===s?void 0:s.total]}),(0,N.jsx)("div",{className:"text-sm text-gray-300",children:C(e)})]})]})}),e.status!==d.w8.CANCELLED&&(0,N.jsxs)("div",{className:"px-6 py-3 bg-white/5",children:[(0,N.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,N.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Order Progress"}),(0,N.jsxs)("span",{className:"text-sm text-gray-400",children:[L(e.status),"%"]})]}),(0,N.jsx)("div",{className:"w-full bg-white/10 rounded-full h-2",children:(0,N.jsx)("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 h-2 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(L(e.status),"%")}})}),(0,N.jsxs)("div",{className:"flex justify-between mt-3 text-xs",children:[(0,N.jsx)("span",{className:e.status===d.w8.PENDING?"text-orange-300 font-medium":"text-gray-400",children:"Pending"}),(0,N.jsx)("span",{className:e.status===d.w8.CONFIRMED?"text-orange-300 font-medium":"text-gray-400",children:"Confirmed"}),(0,N.jsx)("span",{className:e.status===d.w8.PREPARING?"text-orange-300 font-medium":"text-gray-400",children:"Preparing"}),(0,N.jsx)("span",{className:e.status===d.w8.OUT_FOR_DELIVERY?"text-orange-300 font-medium":"text-gray-400",children:"Out for Delivery"}),(0,N.jsx)("span",{className:e.status===d.w8.DELIVERED?"text-green-300 font-medium":"text-gray-400",children:"Delivered"})]})]}),(0,N.jsxs)("div",{className:"p-6",children:[(0,N.jsxs)("div",{className:"mb-4",children:[(0,N.jsx)("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"Items Ordered"}),(0,N.jsxs)("div",{className:"flex flex-wrap gap-2",children:[null===(t=e.items)||void 0===t?void 0:t.slice(0,3).map((e,s)=>(0,N.jsxs)("span",{className:"inline-flex items-center gap-1 text-sm text-gray-200 bg-white/10 px-3 py-1 rounded-full",children:[(0,N.jsx)("span",{className:"w-2 h-2 bg-orange-400 rounded-full"}),e.name," \xd7 ",e.qty]},s)),(null===(r=e.items)||void 0===r?void 0:r.length)>3&&(0,N.jsxs)("span",{className:"text-sm text-gray-400 bg-white/5 px-3 py-1 rounded-full",children:["+",e.items.length-3," more items"]})]})]}),e.deliveryAddress&&(0,N.jsx)("div",{className:"mb-4 p-3 bg-blue-500/10 rounded-lg border border-blue-500/20",children:(0,N.jsxs)("div",{className:"flex items-start gap-2",children:[(0,N.jsx)(g.A,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"text-sm font-medium text-blue-300 mb-1",children:"Delivery Address"}),(0,N.jsxs)("p",{className:"text-sm text-blue-300",children:[e.deliveryAddress.street,(0,N.jsx)("br",{}),e.deliveryAddress.city,", ",e.deliveryAddress.state," ",e.deliveryAddress.pincode,e.deliveryAddress.landmark&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("br",{}),(0,N.jsxs)("span",{className:"text-blue-300",children:["\ud83d\udccd ",e.deliveryAddress.landmark]})]})]}),e.contactNumber&&(0,N.jsxs)("div",{className:"flex items-center gap-1 mt-2",children:[(0,N.jsx)(v.A,{className:"w-3 h-3 text-blue-300"}),(0,N.jsx)("span",{className:"text-sm text-blue-300",children:e.contactNumber})]})]})]})}),(0,N.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mt-4 lg:mt-0 lg:ml-6",children:[(0,N.jsxs)(l.N_,{to:"/order-tracking/".concat(e.id),className:"flex items-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium py-2.5 px-4 rounded-lg transition-all duration-200 shadow-md hover:shadow-lg",children:[(0,N.jsx)(m,{className:"w-4 h-4"}),"Track Order"]}),e.status===d.w8.DELIVERED&&(0,N.jsxs)("button",{onClick:()=>(async()=>{try{i.oR.success("Items added to cart! Redirecting to checkout...")}catch(w){i.oR.error("Failed to reorder items")}})(),className:"flex items-center gap-2 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-medium py-2.5 px-4 rounded-lg transition-all duration-200 shadow-md hover:shadow-lg",children:[(0,N.jsx)(h,{className:"w-4 h-4"}),"Reorder"]}),e.status!==d.w8.DELIVERED&&e.status!==d.w8.CANCELLED&&(0,N.jsxs)("div",{className:"flex items-center gap-2 bg-orange-500/10 text-orange-300 px-3 py-2 rounded-lg border border-orange-500/20",children:[(0,N.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),(0,N.jsx)("span",{className:"text-sm font-medium",children:"Live Tracking"})]})]})]}),(0,N.jsxs)("details",{className:"mt-4",children:[(0,N.jsx)("summary",{className:"cursor-pointer text-sm text-gray-300 hover:text-white",children:"View order details"}),(0,N.jsxs)("div",{className:"mt-3 pt-3 border-t border-white/10",children:[(0,N.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-medium text-white mb-2",children:"Items Ordered"}),(0,N.jsx)("div",{className:"space-y-2",children:null===(a=e.items)||void 0===a?void 0:a.map((e,s)=>(0,N.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,N.jsxs)("span",{className:"text-gray-300",children:[e.name," \xd7 ",e.qty]}),(0,N.jsxs)("span",{className:"text-white",children:["\u20b9",e.price*e.qty]})]},s))})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h4",{className:"font-medium text-white mb-2",children:"Delivery Address"}),(0,N.jsxs)("p",{className:"text-sm text-gray-300",children:[null===(n=e.deliveryAddress)||void 0===n?void 0:n.street,(0,N.jsx)("br",{}),null===(c=e.deliveryAddress)||void 0===c?void 0:c.city,", ",null===(o=e.deliveryAddress)||void 0===o?void 0:o.state,(0,N.jsx)("br",{}),null===(x=e.deliveryAddress)||void 0===x?void 0:x.pincode]}),e.specialInstructions&&(0,N.jsxs)("div",{className:"mt-2",children:[(0,N.jsx)("h4",{className:"font-medium text-white text-sm",children:"Special Instructions"}),(0,N.jsx)("p",{className:"text-sm text-gray-300",children:e.specialInstructions})]})]})]}),(0,N.jsx)("div",{className:"mt-4 pt-3 border-t border-white/10",children:(0,N.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,N.jsxs)("div",{className:"space-y-1",children:[(0,N.jsxs)("div",{className:"flex justify-between w-48",children:[(0,N.jsx)("span",{className:"text-gray-300",children:"Subtotal:"}),(0,N.jsxs)("span",{className:"text-white",children:["\u20b9",null===(u=e.pricing)||void 0===u?void 0:u.subtotal]})]}),(0,N.jsxs)("div",{className:"flex justify-between w-48",children:[(0,N.jsx)("span",{className:"text-gray-300",children:"Delivery Fee:"}),(0,N.jsx)("span",{className:"text-white",children:0===(null===(p=e.pricing)||void 0===p?void 0:p.deliveryFee)?"Free":"\u20b9".concat(null===(b=e.pricing)||void 0===b?void 0:b.deliveryFee)})]}),(0,N.jsxs)("div",{className:"flex justify-between w-48",children:[(0,N.jsx)("span",{className:"text-gray-300",children:"Taxes:"}),(0,N.jsxs)("span",{className:"text-white",children:["\u20b9",null===(j=e.pricing)||void 0===j?void 0:j.taxes]})]})]}),(0,N.jsxs)("div",{className:"text-right",children:[(0,N.jsxs)("div",{className:"text-lg font-semibold text-orange-300",children:["Total: \u20b9",null===(y=e.pricing)||void 0===y?void 0:y.total]}),(0,N.jsx)("div",{className:"text-sm text-gray-300",children:"cash_on_delivery"===e.paymentMethod?"Cash on Delivery":e.paymentMethod})]})]})})]})]})]},e.id)};return b?(0,N.jsx)("div",{className:"max-w-6xl mx-auto p-6 text-gray-100 relative min-h-screen bg-gradient-to-br from-gray-950 via-black to-gray-900",children:(0,N.jsxs)("div",{className:"animate-pulse",children:[(0,N.jsx)("div",{className:"h-8 bg-white/10 rounded w-1/3 mb-6"}),(0,N.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,N.jsx)("div",{className:"h-32 bg-white/10 rounded-lg"},e))})]})}):w?(0,N.jsx)("div",{className:"max-w-6xl mx-auto p-6 text-center text-gray-100 relative min-h-screen bg-gradient-to-br from-gray-950 via-black to-gray-900",children:(0,N.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-6",children:[(0,N.jsx)("h2",{className:"text-xl font-semibold text-red-300 mb-2",children:"Error Loading Orders"}),(0,N.jsx)("p",{className:"text-red-200",children:w})]})}):(0,N.jsxs)("div",{className:"max-w-6xl mx-auto p-6 text-gray-100 relative min-h-screen bg-gradient-to-br from-gray-950 via-black to-gray-900",children:[(0,N.jsxs)("div",{className:"mb-8",children:[(0,N.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,N.jsx)("div",{className:"p-3 bg-gradient-to-r from-orange-500 to-red-500 rounded-full shadow-lg",children:(0,N.jsx)(h,{className:"w-6 h-6 text-white"})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h1",{className:"text-3xl font-bold text-white",children:"My Orders"}),(0,N.jsx)("p",{className:"text-gray-300",children:"Track your orders with real-time updates"})]})]}),x.length>0&&(0,N.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mt-6",children:[(0,N.jsxs)("div",{className:"bg-blue-500/10 p-4 rounded-lg border border-blue-500/20",children:[(0,N.jsxs)("div",{className:"flex items-center gap-2",children:[(0,N.jsx)(n.A,{className:"w-5 h-5 text-blue-300"}),(0,N.jsx)("span",{className:"text-sm font-medium text-blue-300",children:"Active Orders"})]}),(0,N.jsx)("div",{className:"text-2xl font-bold text-blue-300 mt-1",children:x.filter(e=>e.status!==d.w8.DELIVERED&&e.status!==d.w8.CANCELLED).length})]}),(0,N.jsxs)("div",{className:"bg-green-500/10 p-4 rounded-lg border border-green-500/20",children:[(0,N.jsxs)("div",{className:"flex items-center gap-2",children:[(0,N.jsx)(c.A,{className:"w-5 h-5 text-green-300"}),(0,N.jsx)("span",{className:"text-sm font-medium text-green-300",children:"Delivered"})]}),(0,N.jsx)("div",{className:"text-2xl font-bold text-green-300 mt-1",children:x.filter(e=>e.status===d.w8.DELIVERED).length})]}),(0,N.jsxs)("div",{className:"bg-orange-500/10 p-4 rounded-lg border border-orange-500/20",children:[(0,N.jsxs)("div",{className:"flex items-center gap-2",children:[(0,N.jsx)(h,{className:"w-5 h-5 text-orange-300"}),(0,N.jsx)("span",{className:"text-sm font-medium text-orange-300",children:"Total Orders"})]}),(0,N.jsx)("div",{className:"text-2xl font-bold text-orange-300 mt-1",children:x.length})]})]})]}),(0,N.jsx)("div",{className:"mb-6",children:(0,N.jsx)("div",{className:"border-b border-white/10",children:(0,N.jsx)("nav",{className:"-mb-px flex space-x-8 overflow-x-auto",children:O.map(e=>(0,N.jsxs)("button",{onClick:()=>E(e.value),className:"py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ".concat(f===e.value?"border-orange-500 text-orange-300":"border-transparent text-gray-400 hover:text-gray-200 hover:border-white/20"),children:[e.label,e.count>0&&(0,N.jsx)("span",{className:"ml-2 bg-white/5 text-gray-300 py-0.5 px-2 rounded-full text-xs",children:e.count})]},e.value))})})}),"all"===f?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h2",{className:"text-xl font-bold text-blue-300 mb-4",children:"Active Orders"}),0===I.length?(0,N.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No active orders"}):(0,N.jsx)("div",{className:"space-y-6 mb-10",children:I.map(V)})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("h2",{className:"text-xl font-bold text-green-300 mb-4",children:"Completed Orders"}),0===R.length?(0,N.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No completed orders"}):(0,N.jsx)("div",{className:"space-y-6",children:R.map(V)})]})]}):0===k.length?(0,N.jsxs)("div",{className:"text-center py-12",children:[(0,N.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udf7d\ufe0f"}),(0,N.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"No ".concat(null===(s=O.find(e=>e.value===f))||void 0===s?void 0:s.label.toLowerCase()," orders")}),(0,N.jsx)("p",{className:"text-gray-300 mb-6",children:"You don't have any ".concat(null===(t=O.find(e=>e.value===f))||void 0===t?void 0:t.label.toLowerCase()," orders.")}),(0,N.jsx)(l.N_,{to:"/menu",className:"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200",children:"Browse Menu"})]}):(0,N.jsx)("div",{className:"space-y-6",children:k.map(V)})]})},b=()=>{const{user:e,provider:s}=(0,a.A)(),t="supabase"===s?null===e||void 0===e?void 0:e.id:null===e||void 0===e?void 0:e.uid;return(0,N.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,N.jsx)(p,{userId:t})})}},2054:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(7784).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6245:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(7784).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},8006:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(7784).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},8372:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(7784).A)("chef-hat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]])}}]);
//# sourceMappingURL=133.f0dad6d5.chunk.js.map